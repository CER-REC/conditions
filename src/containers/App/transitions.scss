@import '../../styles/colors';

$defaultTransition: 1s ease-in-out;

$fastEnd: 1s cubic-bezier(0.8, 0, 1, 0.2);
$fastestEnd: 1s cubic-bezier(1, 0, 1, 0);

$fastStart: 1s cubic-bezier(0, 0.8, 0.2, 1);
$fastestStart: 1s cubic-bezier(0, 1, 0, 1);

$faded: 0.3;

/**
 *  Each state inherits the previous values, so we only have to declare the parts
 *  that change at each step.
 */
$states: (
  0: (
    ".guideTranslate": (
      transform: translate(30%, 30%)
    ),
    ".ViewTwo": (pointer-events: none),
    ".ViewTwo .header": (opacity: 0),
    ".ViewTwo .wheel": (opacity: 0),
    ".ViewTwo .companyBreakdown": (opacity: 0),
    ".ViewTwo .menus": (opacity: 0),
    ".ViewTwo .legend": (opacity: 0),
    ".ViewTwo .wheel .Wheel .interactiveItems .PullToSpin": (pointer-events: none),
    ".ViewTwo .wheel .Wheel .interactiveItems .WheelList .list": (pointer-events: none),
    ".ConditionDetails .listPane": (opacity: 0),
    ".ConditionDetails .ProjectHeader": (opacity: 0),
    ".ConditionDetails .contentPane": (opacity: 0),
    ".ViewThree": (
      pointer-events: none,
      visibility: hidden,
    ),
    // Fix for Firefox; the svg's pointer-events: all overrides visibility: hidden
    ".ViewThree .VictoryContainer > svg": (pointer-events: visible !important),
    ".Footer": (
      opacity: 0,

      transition: "opacity $fastStart, height $defaultTransition, visibility 0s 1s",
    ),
  ),
  // 8 resets from View 2 -> 1, just with different transitions
  8: (),
  1: (
    ".guideTranslate": (transform: translate(58%, 76%)),
    ".appControls .BrowseByBtn.location": (opacity: 0),
    ".appControls .GuideTransport": (
      opacity: 1,
      visibility: visible,
      transition: opacity $fastEnd,
    ),
    ".ViewOne": (pointer-events: none),
    ".ViewOne .infoBar": (opacity: 0),
    ".ViewOne .introduction": (transform: "translateY(-100vh)"),
    ".ViewOne .explorer": (transform: "translateY(-100vh)"),
    ".ConditionDetails .contentPane": (opacity: 1),
  ),
  2: (
    ".guideTranslate": (transform: translate(72%, 22%)),
    ".ConditionDetails .contentPane": (opacity: $faded),
    ".ViewTwo .menus": (opacity: 1),
    ".ViewTwo .legend": (opacity: 1),
  ),
  3: (
    ".guideTranslate": (transform: translate(42%, 70%)),
    ".ViewTwo .menus": (opacity: $faded),
    ".ViewTwo .legend": (opacity: $faded),
    ".ConditionDetails .listPane": (opacity: 1),
    ".ConditionDetails .ProjectHeader": (opacity: 1),
  ),
  4: (
    ".guideTranslate": (transform: translate(80%, 10%)),
    ".ConditionDetails .listPane": (opacity: $faded),
    ".ConditionDetails .ProjectHeader": (opacity: $faded),
    ".ViewTwo .companyBreakdown": (opacity: 1),
  ),
  5: (
    ".guideTranslate": (transform: translate(11%, 68%)),
    ".appControls .BrowseBy": (opacity: 0),
    ".appControls .BrowseByBtn.company": (opacity: 0),
    ".appControls .BrowseByBtn.location": (opacity: 0),
    ".ViewTwo .companyBreakdown": (opacity: $faded),
    ".ViewTwo .wheel": (opacity: 1),
  ),
  6: (
    ".guideWrapper": (
      pointer-events: none,
    ),
    ".guideTranslate": (transform: translate(80%, 10%)),
    ".appControls": (transform: translateX(10px)),
    ".appControls .BrowseBy": (opacity: 1),
    ".appControls .BrowseByBtn.company": (opacity: 1),
    ".appControls .BrowseByBtn.location": (
      opacity: 1,
      transform: translateX(-100%),
      ),
    ".appControls .BrowseByBtn.inactive": (
      visibility: hidden,
      opacity: 0,
      transition: "opacity #{$fastStart}, transform #{$defaultTransition}, visibility 0s 1s",
    ),
    ".ViewTwo": (pointer-events: auto),
    ".ViewTwo .wheel .Wheel .interactiveItems .PullToSpin": (pointer-events: auto),
    ".ViewTwo .wheel .Wheel .interactiveItems .WheelList .list": (pointer-events: auto),
    ".ViewTwo .header": (opacity: 1),
    ".ViewTwo .wheel": (opacity: 1),
    ".ViewTwo .companyBreakdown": (opacity: 1),
    ".ViewTwo .menus": (opacity: 1),
    ".ViewTwo .legend": (opacity: 1),
    ".ConditionDetails .listPane": (opacity: 1),
    ".ConditionDetails .ProjectHeader": (opacity: 1),
    ".ConditionDetails .contentPane": (opacity: 1),
    ".Footer": (
      opacity: 1,
      visibility: visible,

      height: 300px,

      transition: "opacity #{$defaultTransition}, height #{$defaultTransition}",
    ),
  ),
  // View 2
  7: (
    ".guideTranslate": (
      visibility: hidden,
      transform: translate(87.22%, 5.77%),
    ),
    ".guideTranslate .Guide": (transform: scale(0.17)),
    ".guideTranslate .CircleContainer": (
      pointer-events: none,
      background-color: $GuideFaded,
    ),
    ".appControls .GuideTransport": (
      visibility: hidden,
      opacity: 0,
      transition: "opacity #{$fastStart}, visibility 0s 1s",

    ),
    ".ViewTwo": (
      transition: "opacity #{$defaultTransition}",
    ),
    ".ViewTwo .wheel .Wheel .interactiveItems .PullToSpin": (pointer-events: all),
    ".ViewTwo .wheel .Wheel .interactiveItems .WheelList .list": (pointer-events: all),
    ".ViewThree": (
      transition: "opacity #{$fastestStart}, visibility 0s 1s",
    ),
  ),
  // View 3
  9: (
    ".appControls .arrowWrapper .browseLabel": (width: 128px),
    ".appControls .BrowseByBtn.active": (
      visibility: hidden,
      opacity: 0,
      transition: "opacity #{$fastStart}, transform #{$defaultTransition}, visibility 0s 1s",
    ),
    ".appControls .BrowseByBtn.inactive": (
      visibility: visible,
      opacity: 1,
      transition: "opacity #{$defaultTransition}, transform #{$defaultTransition}",
    ),
    ".ViewTwo": (
      pointer-events: none,
      visibility: hidden,
      transition: "opacity #{$fastestStart}, visibility 0s 1s",
      opacity: 0,
    ),
    ".ViewTwo .wheel .Wheel .interactiveItems .PullToSpin": (pointer-events: none),
    ".ViewTwo .wheel .Wheel .interactiveItems .WheelList .list": (pointer-events: none),
    ".ViewThree": (
      pointer-events: auto,
      visibility: visible,
      opacity: 1,
      transition: "opacity #{defaultTransition}",
    ),
    ".ViewThree .VictoryContainer > svg": (pointer-events: all !important),
  ),
);

$combinedState: ();

.App {
  @each $stage, $rules in $states {
    &.transition-state-#{$stage} {
      @each $selector, $properties in $rules {
        @if map_has_key($combinedState, $selector) == false {
          $combinedState: map-merge($combinedState, ($selector: ())) !global;
        }

        $combinedState: map-merge(
          $combinedState,
          ($selector: map-merge(map-get($combinedState, $selector), $properties)),
        ) !global;
      }

      @each $selector, $properties in $combinedState {
        #{$selector} {
          @each $property, $value in map-get($combinedState, $selector) {
            #{$property}: #{$value};
          }
        }
      }
    }
  }
}
